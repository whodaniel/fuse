
export {}
import vitest_1 from 'vitest';
import index_1 from '../index.js';
import api_1 from '../../services/api.js';
import agent_1 from '../../types/agent.js';
vitest_1.vi.mock('../../services/api', () => ({
    chatService: {
        startConversation: vitest_1.vi.fn(),
        sendMessage: vitest_1.vi.fn(),
        clearConversation: vitest_1.vi.fn(),
        getConversations: vitest_1.vi.fn(),
        getConversationMessages: vitest_1.vi.fn(),
    },
    agentService: {
        getAllAgents: vitest_1.vi.fn(),
        updateAgent: vitest_1.vi.fn(),
        createAgent: vitest_1.vi.fn(),
        deleteAgent: vitest_1.vi.fn(),
        updateAgentSkills: vitest_1.vi.fn(),
    },
}));
(0, vitest_1.describe)('Store Integration', () => {
    (0, vitest_1.beforeEach)(() => {
        vitest_1.vi.clearAllMocks();
        index_1.default.setState({
            // Agent State
            agents: [],
            selectedAgent: null,
            // Chat State
            chats: [],
            activeChat: null,
            // System State
            isLoading: false,
            error: null,
        });
    });
    (0, vitest_1.describe)('Agent State', () => {
        (0, vitest_1.it)('should update agents', () => {
            const mockAgents = [
                {
                    id: '1',
                    name: 'Agent 1',
                    status: 'idle',
                    type: 'assistant',
                    personality: 'Helpful',
                    skills: ['chat', 'analysis']
                },
                {
                    id: '2',
                    name: 'Agent 2',
                    status: 'busy',
                    type: 'specialist',
                    personality: 'Professional',
                    skills: ['coding', 'debugging']
                },
            ];
            index_1.default.getState().setAgents(mockAgents);
            (0, vitest_1.expect)(index_1.default.getState().agents).toEqual(mockAgents);
        });
        (0, vitest_1.it)('should select an agent', () => {
            const mockAgent = {
                id: '1',
                name: 'Agent 1',
                status: 'idle',
                type: 'assistant',
                personality: 'Helpful',
                skills: ['chat', 'analysis']
            };
            index_1.default.getState().setSelectedAgent(mockAgent);
            (0, vitest_1.expect)(index_1.default.getState().selectedAgent).toEqual(mockAgent);
        });
        (0, vitest_1.it)('should fetch agents', async () => {
            const mockApiAgents = [
                {
                    id: '1',
                    name: 'Agent 1',
                    status: 'idle',
                    type: 'assistant',
                    personality: 'Helpful',
                    skills: ['chat', 'analysis'],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                },
            ];
            const expectedStoreAgents = mockApiAgents.map(agent_1.transformApiToStoreAgent);
            vitest_1.vi.mocked(api_1.agentService.getAllAgents).mockResolvedValue(mockApiAgents);
            await index_1.default.getState().fetchAgents();
            (0, vitest_1.expect)(api_1.agentService.getAllAgents).toHaveBeenCalled();
            (0, vitest_1.expect)(index_1.default.getState().agents).toEqual(expectedStoreAgents);
        });
    });
    (0, vitest_1.describe)('Chat State', () => {
        (0, vitest_1.it)('should update chats', () => {
            const mockChats = [
                { id: '1', title: 'Chat 1', messages: [] },
                { id: '2', title: 'Chat 2', messages: [] },
            ];
            index_1.default.getState().setChats(mockChats);
            (0, vitest_1.expect)(index_1.default.getState().chats).toEqual(mockChats);
        });
        (0, vitest_1.it)('should set active chat', () => {
            const mockChat = { id: '1', title: 'Chat 1', messages: [] };
            index_1.default.getState().setActiveChat(mockChat);
            (0, vitest_1.expect)(index_1.default.getState().activeChat).toEqual(mockChat);
        });
        (0, vitest_1.it)('should add message to chat', () => {
            const mockChat = { id: '1', title: 'Chat 1', messages: [] };
            const mockMessage = {
                id: '1',
                sender: 'user',
                content: 'Hello',
                timestamp: new Date(),
            };
            index_1.default.getState().setChats([mockChat]);
            index_1.default.getState().setActiveChat(mockChat);
            index_1.default.getState().addMessage(mockChat.id, mockMessage);
            const updatedChat = index_1.default.getState().chats[0];
            (0, vitest_1.expect)(updatedChat.messages).toHaveLength(1);
            (0, vitest_1.expect)(updatedChat.messages[0]).toEqual(mockMessage);
        });
        (0, vitest_1.it)('should create a new chat', async () => {
            const mockResponse = {
                status: 'success',
                conversationId: 1,
                message: 'Conversation started',
            };
            vitest_1.vi.mocked(api_1.chatService.startConversation).mockResolvedValue(mockResponse);
            await index_1.default.getState().createChat('user1');
            (0, vitest_1.expect)(api_1.chatService.startConversation).toHaveBeenCalledWith('user1');
            (0, vitest_1.expect)(index_1.default.getState().chats).toHaveLength(1);
            (0, vitest_1.expect)(index_1.default.getState().activeChat?.id).toBe('1');
        });
    });
    (0, vitest_1.describe)('System State', () => {
        (0, vitest_1.it)('should update loading state', () => {
            index_1.default.getState().setLoading(true);
            (0, vitest_1.expect)(index_1.default.getState().isLoading).toBe(true);
            index_1.default.getState().setLoading(false);
            (0, vitest_1.expect)(index_1.default.getState().isLoading).toBe(false);
        });
        (0, vitest_1.it)('should update error state', () => {
            const errorMessage = 'Test error';
            index_1.default.getState().setError(errorMessage);
            (0, vitest_1.expect)(index_1.default.getState().error).toBe(errorMessage);
            index_1.default.getState().setError(null);
            (0, vitest_1.expect)(index_1.default.getState().error).toBeNull();
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmUudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInN0b3JlLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtQ0FBOEQ7QUFDOUQsb0NBQWdDO0FBQ2hDLDRDQUErRDtBQUUvRCw2Q0FBZ0c7QUFHaEcsV0FBRSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ25DLFdBQVcsRUFBRTtRQUNYLGlCQUFpQixFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDMUIsV0FBVyxFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDcEIsaUJBQWlCLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUMxQixnQkFBZ0IsRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO1FBQ3pCLHVCQUF1QixFQUFFLFdBQUUsQ0FBQyxFQUFFLEVBQUU7S0FDakM7SUFDRCxZQUFZLEVBQUU7UUFDWixZQUFZLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNyQixXQUFXLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNwQixXQUFXLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNwQixXQUFXLEVBQUUsV0FBRSxDQUFDLEVBQUUsRUFBRTtRQUNwQixpQkFBaUIsRUFBRSxXQUFFLENBQUMsRUFBRSxFQUFFO0tBQzNCO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFFSixJQUFBLGlCQUFRLEVBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO0lBQ2pDLElBQUEsbUJBQVUsRUFBQyxHQUFHLEVBQUU7UUFDZCxXQUFFLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDbkIsZUFBUSxDQUFDLFFBQVEsQ0FBQztZQUNoQixjQUFjO1lBQ2QsTUFBTSxFQUFFLEVBQUU7WUFDVixhQUFhLEVBQUUsSUFBSTtZQUNuQixhQUFhO1lBQ2IsS0FBSyxFQUFFLEVBQUU7WUFDVCxVQUFVLEVBQUUsSUFBSTtZQUNoQixlQUFlO1lBQ2YsU0FBUyxF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QUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIHZpIH0gZnJvbSAndml0ZXN0JztcbmltcG9ydCB1c2VTdG9yZSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBjaGF0U2VydmljZSwgYWdlbnRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvYXBpJztcbmltcG9ydCB7IENoYXQsIE1lc3NhZ2UgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBTdG9yZUFnZW50LCBBZ2VudFN0YXR1cywgQXBpQWdlbnQsIHRyYW5zZm9ybUFwaVRvU3RvcmVBZ2VudCB9IGZyb20gJy4uLy4uL3R5cGVzL2FnZW50JztcbmltcG9ydCB7IENvbnZlcnNhdGlvblN0YXJ0UmVzcG9uc2UgfSBmcm9tICcuLi8uLi90eXBlcy9hcGknO1xuXG52aS5tb2NrKCcuLi8uLi9zZXJ2aWNlcy9hcGknLCAoKSA9PiAoe1xuICBjaGF0U2VydmljZToge1xuICAgIHN0YXJ0Q29udmVyc2F0aW9uOiB2aS5mbigpLFxuICAgIHNlbmRNZXNzYWdlOiB2aS5mbigpLFxuICAgIGNsZWFyQ29udmVyc2F0aW9uOiB2aS5mbigpLFxuICAgIGdldENvbnZlcnNhdGlvbnM6IHZpLmZuKCksXG4gICAgZ2V0Q29udmVyc2F0aW9uTWVzc2FnZXM6IHZpLmZuKCksXG4gIH0sXG4gIGFnZW50U2VydmljZToge1xuICAgIGdldEFsbEFnZW50czogdmkuZm4oKSxcbiAgICB1cGRhdGVBZ2VudDogdmkuZm4oKSxcbiAgICBjcmVhdGVBZ2VudDogdmkuZm4oKSxcbiAgICBkZWxldGVBZ2VudDogdmkuZm4oKSxcbiAgICB1cGRhdGVBZ2VudFNraWxsczogdmkuZm4oKSxcbiAgfSxcbn0pKTtcblxuZGVzY3JpYmUoJ1N0b3JlIEludGVncmF0aW9uJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB2aS5jbGVhckFsbE1vY2tzKCk7XG4gICAgdXNlU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgLy8gQWdlbnQgU3RhdGVcbiAgICAgIGFnZW50czogW10sXG4gICAgICBzZWxlY3RlZEFnZW50OiBudWxsLFxuICAgICAgLy8gQ2hhdCBTdGF0ZVxuICAgICAgY2hhdHM6IFtdLFxuICAgICAgYWN0aXZlQ2hhdDogbnVsbCxcbiAgICAgIC8vIFN5c3RlbSBTdGF0ZVxuICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGVycm9yOiBudWxsLFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWdlbnQgU3RhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgYWdlbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0FnZW50czogU3RvcmVBZ2VudFtdID0gW1xuICAgICAgICB7IFxuICAgICAgICAgIGlkOiAnMScsIFxuICAgICAgICAgIG5hbWU6ICdBZ2VudCAxJywgXG4gICAgICAgICAgc3RhdHVzOiAnaWRsZScgYXMgQWdlbnRTdGF0dXMsXG4gICAgICAgICAgdHlwZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgcGVyc29uYWxpdHk6ICdIZWxwZnVsJyxcbiAgICAgICAgICBza2lsbHM6IFsnY2hhdCcsICdhbmFseXNpcyddXG4gICAgICAgIH0sXG4gICAgICAgIHsgXG4gICAgICAgICAgaWQ6ICcyJywgXG4gICAgICAgICAgbmFtZTogJ0FnZW50IDInLCBcbiAgICAgICAgICBzdGF0dXM6ICdidXN5JyBhcyBBZ2VudFN0YXR1cyxcbiAgICAgICAgICB0eXBlOiAnc3BlY2lhbGlzdCcsXG4gICAgICAgICAgcGVyc29uYWxpdHk6ICdQcm9mZXNzaW9uYWwnLFxuICAgICAgICAgIHNraWxsczogWydjb2RpbmcnLCAnZGVidWdnaW5nJ11cbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIHVzZVN0b3JlLmdldFN0YXRlKCkuc2V0QWdlbnRzKG1vY2tBZ2VudHMpO1xuICAgICAgZXhwZWN0KHVzZVN0b3JlLmdldFN0YXRlKCkuYWdlbnRzKS50b0VxdWFsKG1vY2tBZ2VudHMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZWxlY3QgYW4gYWdlbnQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrQWdlbnQ6IFN0b3JlQWdlbnQgPSB7IFxuICAgICAgICBpZDogJzEnLCBcbiAgICAgICAgbmFtZTogJ0FnZW50IDEnLCBcbiAgICAgICAgc3RhdHVzOiAnaWRsZScgYXMgQWdlbnRTdGF0dXMsXG4gICAgICAgIHR5cGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICBwZXJzb25hbGl0eTogJ0hlbHBmdWwnLFxuICAgICAgICBza2lsbHM6IFsnY2hhdCcsICdhbmFseXNpcyddXG4gICAgICB9O1xuICAgICAgdXNlU3RvcmUuZ2V0U3RhdGUoKS5zZXRTZWxlY3RlZEFnZW50KG1vY2tBZ2VudCk7XG4gICAgICBleHBlY3QodXNlU3RvcmUuZ2V0U3RhdGUoKS5zZWxlY3RlZEFnZW50KS50b0VxdWFsKG1vY2tBZ2VudCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZldGNoIGFnZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tBcGlBZ2VudHM6IEFwaUFnZW50W10gPSBbXG4gICAgICAgIHsgXG4gICAgICAgICAgaWQ6ICcxJywgXG4gICAgICAgICAgbmFtZTogJ0FnZW50IDEnLCBcbiAgICAgICAgICBzdGF0dXM6ICdpZGxlJyxcbiAgICAgICAgICB0eXBlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgICBwZXJzb25hbGl0eTogJ0hlbHBmdWwnLFxuICAgICAgICAgIHNraWxsczogWydjaGF0JywgJ2FuYWx5c2lzJ10sXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBleHBlY3RlZFN0b3JlQWdlbnRzID0gbW9ja0FwaUFnZW50cy5tYXAodHJhbnNmb3JtQXBpVG9TdG9yZUFnZW50KTtcblxuICAgICAgdmkubW9ja2VkKGFnZW50U2VydmljZS5nZXRBbGxBZ2VudHMpLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tBcGlBZ2VudHMpO1xuXG4gICAgICBhd2FpdCB1c2VTdG9yZS5nZXRTdGF0ZSgpLmZldGNoQWdlbnRzKCk7XG4gICAgICBleHBlY3QoYWdlbnRTZXJ2aWNlLmdldEFsbEFnZW50cykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHVzZVN0b3JlLmdldFN0YXRlKCkuYWdlbnRzKS50b0VxdWFsKGV4cGVjdGVkU3RvcmVBZ2VudHMpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2hhdCBTdGF0ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBjaGF0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tDaGF0czogQ2hhdFtdID0gW1xuICAgICAgICB7IGlkOiAnMScsIHRpdGxlOiAnQ2hhdCAxJywgbWVzc2FnZXM6IFtdIH0sXG4gICAgICAgIHsgaWQ6ICcyJywgdGl0bGU6ICdDaGF0IDInLCBtZXNzYWdlczogW10gfSxcbiAgICAgIF07XG5cbiAgICAgIHVzZVN0b3JlLmdldFN0YXRlKCkuc2V0Q2hhdHMobW9ja0NoYXRzKTtcbiAgICAgIGV4cGVjdCh1c2VTdG9yZS5nZXRTdGF0ZSgpLmNoYXRzKS50b0VxdWFsKG1vY2tDaGF0cyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNldCBhY3RpdmUgY2hhdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tDaGF0OiBDaGF0ID0geyBpZDogJzEnLCB0aXRsZTogJ0NoYXQgMScsIG1lc3NhZ2VzOiBbXSB9O1xuICAgICAgdXNlU3RvcmUuZ2V0U3RhdGUoKS5zZXRBY3RpdmVDaGF0KG1vY2tDaGF0KTtcbiAgICAgIGV4cGVjdCh1c2VTdG9yZS5nZXRTdGF0ZSgpLmFjdGl2ZUNoYXQpLnRvRXF1YWwobW9ja0NoYXQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhZGQgbWVzc2FnZSB0byBjaGF0JywgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0NoYXQ6IENoYXQgPSB7IGlkOiAnMScsIHRpdGxlOiAnQ2hhdCAxJywgbWVzc2FnZXM6IFtdIH07XG4gICAgICBjb25zdCBtb2NrTWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgICAgaWQ6ICcxJyxcbiAgICAgICAgc2VuZGVyOiAndXNlcicsXG4gICAgICAgIGNvbnRlbnQ6ICdIZWxsbycsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIHVzZVN0b3JlLmdldFN0YXRlKCkuc2V0Q2hhdHMoW21vY2tDaGF0XSk7XG4gICAgICB1c2VTdG9yZS5nZXRTdGF0ZSgpLnNldEFjdGl2ZUNoYXQobW9ja0NoYXQpO1xuICAgICAgdXNlU3RvcmUuZ2V0U3RhdGUoKS5hZGRNZXNzYWdlKG1vY2tDaGF0LmlkLCBtb2NrTWVzc2FnZSk7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRDaGF0ID0gdXNlU3RvcmUuZ2V0U3RhdGUoKS5jaGF0c1swXTtcbiAgICAgIGV4cGVjdCh1cGRhdGVkQ2hhdC5tZXNzYWdlcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWRDaGF0Lm1lc3NhZ2VzWzBdKS50b0VxdWFsKG1vY2tNZXNzYWdlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgbmV3IGNoYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUmVzcG9uc2U6IENvbnZlcnNhdGlvblN0YXJ0UmVzcG9uc2UgPSB7XG4gICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogMSxcbiAgICAgICAgbWVzc2FnZTogJ0NvbnZlcnNhdGlvbiBzdGFydGVkJyxcbiAgICAgIH07XG5cbiAgICAgIHZpLm1vY2tlZChjaGF0U2VydmljZS5zdGFydENvbnZlcnNhdGlvbikubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jlc3BvbnNlKTtcblxuICAgICAgYXdhaXQgdXNlU3RvcmUuZ2V0U3RhdGUoKS5jcmVhdGVDaGF0KCd1c2VyMScpO1xuICAgICAgZXhwZWN0KGNoYXRTZXJ2aWNlLnN0YXJ0Q29udmVyc2F0aW9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndXNlcjEnKTtcbiAgICAgIGV4cGVjdCh1c2VTdG9yZS5nZXRTdGF0ZSgpLmNoYXRzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QodXNlU3RvcmUuZ2V0U3RhdGUoKS5hY3RpdmVDaGF0Py5pZCkudG9CZSgnMScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3lzdGVtIFN0YXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGxvYWRpbmcgc3RhdGUnLCAoKSA9PiB7XG4gICAgICB1c2VTdG9yZS5nZXRTdGF0ZSgpLnNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBleHBlY3QodXNlU3RvcmUuZ2V0U3RhdGUoKS5pc0xvYWRpbmcpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIHVzZVN0b3JlLmdldFN0YXRlKCkuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICBleHBlY3QodXNlU3RvcmUuZ2V0U3RhdGUoKS5pc0xvYWRpbmcpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgZXJyb3Igc3RhdGUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSAnVGVzdCBlcnJvcic7XG4gICAgICB1c2VTdG9yZS5nZXRTdGF0ZSgpLnNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICBleHBlY3QodXNlU3RvcmUuZ2V0U3RhdGUoKS5lcnJvcikudG9CZShlcnJvck1lc3NhZ2UpO1xuXG4gICAgICB1c2VTdG9yZS5nZXRTdGF0ZSgpLnNldEVycm9yKG51bGwpO1xuICAgICAgZXhwZWN0KHVzZVN0b3JlLmdldFN0YXRlKCkuZXJyb3IpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=
export {};
